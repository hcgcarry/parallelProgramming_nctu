import numpy as np 
from scipy.optimize import leastsq
import pylab as pl
 
#x = np.arange(1, 17, 1)
x = ([8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824])

#y = ([0.000000372,0.000000248,0.000000520,0.000000511,0.000000689,0.000000450,0.000000622,0.000000810,0.000000906,0.000002707,0.000002679,0.000003439,0.000004443,0.000006700,0.000011235,0.000020794,0.000040659,0.000074663,0.000221238,0.000527912,0.001390096,0.002858385,0.005627454,0.010987167,0.021104410,0.041579062,0.082155374,0.176507593])
#y = ([0.000001109,0.000000713,0.000000741,0.000000729,0.000000860,0.000000922,0.000001388,0.000001499,0.000001789,0.000006044,0.000007603,0.000009796,0.000013139,0.000020187,0.000033319,0.000049218,0.000065747,0.000093090,0.000155244,0.000530926,0.001341776,0.002749832,0.005411836,0.010690388,0.020941825,0.041206492,0.093380534,0.170966485])
different_node_y=([0.000053207,0.000053076,0.000053024,0.000053105,0.000052947,0.000052892,0.000052833,0.000061093,0.000092809,0.000092516,0.000165758,0.000208130,0.000362717,0.000753946,0.001325812,0.002415780,0.004871212,0.00922760,0.018518532,0.036424857,0.072595909,0.145564153,0.289037154,0.594184549,1.213965873,2.331109251,4.17040360,9.248197688])


#z1 = np.polyfit(x, y, 1)
z1 = np.polyfit(x, different_node_y, 1)
#p1 = np.poly1d(z1)
print("parameter:" ,z1)
#pl.plot(x, y, 'b^-', label='Origin Line')
pl.plot(x, different_node_y, 'b^-', label='Origin Line')
#pl.plot(x, p1(x), 'gv--', label='Poly Fitting Line(deg=3)')
#pl.plot(x, np.polyval(z1, x))
pl.show()

"""
x = ([8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824])

y = ([0.000001109,0.000000713,0.000000741,0.000000729,0.000000860,0.000000922,0.000001388,0.000001499,0.000001789,0.000006044,0.000007603,0.000009796,0.000013139,0.000020187,0.000033319,0.000049218,0.000065747,0.000093090,0.000155244,0.000530926,0.001341776,0.002749832,0.005411836,0.010690388,0.020941825,0.041206492,0.093380534,0.170966485])

z1 = np.polyfit(x, y, 1)
p1 = np.poly1d(z1)
print("parameter:" ,z1)
print(p1)
pl.plot(x, y, 'b^-', label='Origin Line')
#pl.plot(x, p1(x), 'gv--', label='Poly Fitting Line(deg=3)')
#pl.plot(x, np.polyval(z1, x))
pl.show()
"""